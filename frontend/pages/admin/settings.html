<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - Prestigio Motors Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gold: '#d4af37',
                        'gold-light': '#e6c757',
                        'gold-dark': '#b8941f'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-black text-white min-h-screen">
    <div class="container mx-auto px-6 py-8">
        <!-- Header -->
        <div class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-bold text-gold mb-2">Admin Settings</h1>
                <p class="text-gray-400">Manage your admin profile and dealership settings</p>
            </div>
            <button onclick="window.history.back()" class="bg-gray-800 hover:bg-gray-700 px-4 py-2 rounded-lg transition-colors">
                <i class="fas fa-arrow-left mr-2"></i>Back
            </button>
        </div>

        <!-- Settings Navigation -->
        <div class="bg-gray-900 rounded-lg mb-8">
            <div class="flex border-b border-gray-700">
                <button onclick="showSection('profile')" id="profileTab" class="px-6 py-4 text-gold border-b-2 border-gold font-semibold">
                    <i class="fas fa-user mr-2"></i>Profile Settings
                </button>
                <button onclick="showSection('security')" id="securityTab" class="px-6 py-4 text-gray-400 hover:text-white transition-colors">
                    <i class="fas fa-shield-alt mr-2"></i>Security
                </button>
                <button onclick="showSection('dealership')" id="dealershipTab" class="px-6 py-4 text-gray-400 hover:text-white transition-colors">
                    <i class="fas fa-building mr-2"></i>Dealership Info
                </button>
                <button onclick="showSection('system')" id="systemTab" class="px-6 py-4 text-gray-400 hover:text-white transition-colors">
                    <i class="fas fa-cog mr-2"></i>System Settings
                </button>
                <button onclick="showSection('backup')" id="backupTab" class="px-6 py-4 text-gray-400 hover:text-white transition-colors">
                    <i class="fas fa-database mr-2"></i>Backup & Data
                </button>
            </div>
        </div>

        <!-- Profile Settings Section -->
        <div id="profileSection" class="settings-section">
            <div class="bg-gray-900 rounded-lg p-8">
                <h2 class="text-2xl font-bold text-gold mb-6">Profile Settings</h2>
                <form id="profileForm" onsubmit="updateProfile(event)">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium mb-2">Full Name</label>
                            <input type="text" id="fullName" value="Moamen Mohy" required
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Username</label>
                            <input type="text" id="username" value="admin" required
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email</label>
                            <input type="email" id="email" value="admin@prestigiomotors.com" required
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Phone</label>
                            <input type="tel" id="phone" value="+1 (555) 123-4567"
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Role</label>
                            <select id="role" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                                <option value="admin" selected>Administrator</option>
                                <option value="manager">Manager</option>
                                <option value="sales">Sales Representative</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Department</label>
                            <input type="text" id="department" value="Administration"
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                    </div>
                    <div class="mt-6">
                        <label class="block text-sm font-medium mb-2">Profile Picture URL</label>
                        <input type="url" id="profilePicture" value="images/orange.jpg"
                               class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                    </div>
                    <div class="flex justify-end mt-8">
                        <button type="submit" class="bg-gold hover:bg-gold-dark text-black px-6 py-3 rounded-lg font-semibold transition-colors">
                            <i class="fas fa-save mr-2"></i>Update Profile
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Security Settings Section -->
        <div id="securitySection" class="settings-section hidden">
            <div class="space-y-8">
                <!-- Change Password -->
                <div class="bg-gray-900 rounded-lg p-8">
                    <h2 class="text-2xl font-bold text-gold mb-6">Change Password</h2>
                    <form id="passwordForm" onsubmit="changePassword(event)">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Current Password</label>
                                <input type="password" id="currentPassword" required
                                       class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">New Password</label>
                                <input type="password" id="newPassword" required minlength="8"
                                       class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Confirm New Password</label>
                                <input type="password" id="confirmPassword" required
                                       class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                            </div>
                        </div>
                        <div class="flex justify-end mt-6">
                            <button type="submit" class="bg-red-600 hover:bg-red-700 px-6 py-3 rounded-lg font-semibold transition-colors">
                                <i class="fas fa-key mr-2"></i>Change Password
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Two-Factor Authentication -->
                <div class="bg-gray-900 rounded-lg p-8">
                    <h2 class="text-2xl font-bold text-gold mb-6">Two-Factor Authentication</h2>
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold mb-2">Enable 2FA</h3>
                            <p class="text-gray-400 text-sm">Add an extra layer of security to your account</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="twoFactorToggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-gold rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gold"></div>
                        </label>
                    </div>
                </div>

                <!-- Session Management -->
                <div class="bg-gray-900 rounded-lg p-8">
                    <h2 class="text-2xl font-bold text-gold mb-6">Session Management</h2>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="font-semibold">Session Timeout</h3>
                                <p class="text-gray-400 text-sm">Automatically log out after inactivity</p>
                            </div>
                            <select id="sessionTimeout" class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-gold focus:border-transparent">
                                <option value="15">15 minutes</option>
                                <option value="30">30 minutes</option>
                                <option value="60" selected>1 hour</option>
                                <option value="120">2 hours</option>
                                <option value="480">8 hours</option>
                            </select>
                        </div>
                        <div class="flex justify-end">
                            <button onclick="logoutAllSessions()" class="bg-red-600 hover:bg-red-700 px-6 py-2 rounded-lg transition-colors">
                                <i class="fas fa-sign-out-alt mr-2"></i>Logout All Sessions
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dealership Info Section -->
        <div id="dealershipSection" class="settings-section hidden">
            <div class="bg-gray-900 rounded-lg p-8">
                <h2 class="text-2xl font-bold text-gold mb-6">Dealership Information</h2>
                <form id="dealershipForm" onsubmit="updateDealershipInfo(event)">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium mb-2">Dealership Name</label>
                            <input type="text" id="dealershipName" value="Prestigio Motors" required
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Business License</label>
                            <input type="text" id="businessLicense" value="DL-2023-001234"
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Phone Number</label>
                            <input type="tel" id="dealershipPhone" value="+1 (555) 987-6543" required
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email</label>
                            <input type="email" id="dealershipEmail" value="info@prestigiomotors.com" required
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium mb-2">Address</label>
                            <textarea id="dealershipAddress" rows="3" required
                                      class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">123 Luxury Avenue, Beverly Hills, CA 90210, United States</textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Website</label>
                            <input type="url" id="dealershipWebsite" value="https://prestigiomotors.com"
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Tax ID</label>
                            <input type="text" id="taxId" value="12-3456789"
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                    </div>
                    <div class="mt-6">
                        <label class="block text-sm font-medium mb-2">Business Hours</label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs text-gray-400 mb-1">Weekdays</label>
                                <input type="text" id="weekdayHours" value="9:00 AM - 8:00 PM"
                                       class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-gold focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-xs text-gray-400 mb-1">Weekends</label>
                                <input type="text" id="weekendHours" value="10:00 AM - 6:00 PM"
                                       class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-gold focus:border-transparent">
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-end mt-8">
                        <button type="submit" class="bg-gold hover:bg-gold-dark text-black px-6 py-3 rounded-lg font-semibold transition-colors">
                            <i class="fas fa-save mr-2"></i>Update Information
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- System Settings Section -->
        <div id="systemSection" class="settings-section hidden">
            <div class="space-y-8">
                <!-- General Settings -->
                <div class="bg-gray-900 rounded-lg p-8">
                    <h2 class="text-2xl font-bold text-gold mb-6">General Settings</h2>
                    <div class="space-y-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="font-semibold">Email Notifications</h3>
                                <p class="text-gray-400 text-sm">Receive email notifications for new orders and messages</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="emailNotifications" checked class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-gold rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gold"></div>
                            </label>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="font-semibold">Auto-refresh Dashboard</h3>
                                <p class="text-gray-400 text-sm">Automatically refresh dashboard data</p>
                            </div>
                            <select id="autoRefresh" class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-gold focus:border-transparent">
                                <option value="0">Disabled</option>
                                <option value="30" selected>30 seconds</option>
                                <option value="60">1 minute</option>
                                <option value="300">5 minutes</option>
                            </select>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="font-semibold">Theme</h3>
                                <p class="text-gray-400 text-sm">Choose your preferred theme</p>
                            </div>
                            <select id="theme" class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-gold focus:border-transparent">
                                <option value="dark" selected>Dark</option>
                                <option value="light">Light</option>
                                <option value="auto">Auto</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- API Settings -->
                <div class="bg-gray-900 rounded-lg p-8">
                    <h2 class="text-2xl font-bold text-gold mb-6">API Settings</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">API Base URL</label>
                            <input type="url" id="apiBaseUrl" value="http://localhost:5000/api"
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Request Timeout (seconds)</label>
                            <input type="number" id="requestTimeout" value="30" min="5" max="300"
                                   class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-gold focus:border-transparent">
                        </div>
                        <div class="flex justify-end">
                            <button onclick="testApiConnection()" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg transition-colors">
                                <i class="fas fa-plug mr-2"></i>Test Connection
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Backup & Data Section -->
        <div id="backupSection" class="settings-section hidden">
            <div class="space-y-8">
                <!-- Database Backup -->
                <div class="bg-gray-900 rounded-lg p-8">
                    <h2 class="text-2xl font-bold text-gold mb-6">Database Backup</h2>
                    <div class="space-y-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="font-semibold">Automatic Backups</h3>
                                <p class="text-gray-400 text-sm">Schedule automatic database backups</p>
                            </div>
                            <select id="backupFrequency" class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-gold focus:border-transparent">
                                <option value="disabled">Disabled</option>
                                <option value="daily" selected>Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly">Monthly</option>
                            </select>
                        </div>
                        <div class="flex gap-4">
                            <button onclick="createBackup()" class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded-lg transition-colors">
                                <i class="fas fa-download mr-2"></i>Create Backup Now
                            </button>
                            <button onclick="restoreBackup()" class="bg-yellow-600 hover:bg-yellow-700 px-6 py-3 rounded-lg transition-colors">
                                <i class="fas fa-upload mr-2"></i>Restore Backup
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Data Management -->
                <div class="bg-gray-900 rounded-lg p-8">
                    <h2 class="text-2xl font-bold text-gold mb-6">Data Management</h2>
                    <div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-gray-800 rounded-lg p-4 text-center">
                                <i class="fas fa-car text-gold text-2xl mb-2"></i>
                                <h4 class="font-semibold mb-1">Vehicles</h4>
                                <p id="vehicleCount" class="text-2xl font-bold text-gold">0</p>
                            </div>
                            <div class="bg-gray-800 rounded-lg p-4 text-center">
                                <i class="fas fa-users text-blue-400 text-2xl mb-2"></i>
                                <h4 class="font-semibold mb-1">Customers</h4>
                                <p id="customerCount" class="text-2xl font-bold text-blue-400">0</p>
                            </div>
                            <div class="bg-gray-800 rounded-lg p-4 text-center">
                                <i class="fas fa-shopping-cart text-green-400 text-2xl mb-2"></i>
                                <h4 class="font-semibold mb-1">Orders</h4>
                                <p id="orderCount" class="text-2xl font-bold text-green-400">0</p>
                            </div>
                        </div>
                        <div class="flex gap-4">
                            <button onclick="exportData()" class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg transition-colors">
                                <i class="fas fa-file-export mr-2"></i>Export All Data
                            </button>
                            <button onclick="clearCache()" class="bg-orange-600 hover:bg-orange-700 px-6 py-3 rounded-lg transition-colors">
                                <i class="fas fa-broom mr-2"></i>Clear Cache
                            </button>
                            <button onclick="resetDatabase()" class="bg-red-600 hover:bg-red-700 px-6 py-3 rounded-lg transition-colors">
                                <i class="fas fa-exclamation-triangle mr-2"></i>Reset Database
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:5000/api';
        let currentSection = 'profile';

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadDataCounts();
        });

        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('.settings-section').forEach(el => el.classList.add('hidden'));
            
            // Remove active state from all tabs
            document.querySelectorAll('[id$="Tab"]').forEach(tab => {
                tab.classList.remove('text-gold', 'border-b-2', 'border-gold', 'font-semibold');
                tab.classList.add('text-gray-400');
            });
            
            // Show selected section
            document.getElementById(section + 'Section').classList.remove('hidden');
            
            // Add active state to selected tab
            const activeTab = document.getElementById(section + 'Tab');
            activeTab.classList.remove('text-gray-400');
            activeTab.classList.add('text-gold', 'border-b-2', 'border-gold', 'font-semibold');
            
            currentSection = section;
        }

        async function updateProfile(event) {
            event.preventDefault();
            
            const profileData = {
                fullName: document.getElementById('fullName').value,
                username: document.getElementById('username').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                role: document.getElementById('role').value,
                department: document.getElementById('department').value,
                profilePicture: document.getElementById('profilePicture').value
            };
            
            try {
                // In a real implementation, you would make an API call
                // const response = await fetch(`${API_BASE}/admin/profile`, {
                //     method: 'PUT',
                //     headers: { 'Content-Type': 'application/json' },
                //     body: JSON.stringify(profileData)
                // });
                
                showNotification('Profile updated successfully!', 'success');
                
            } catch (error) {
                console.error('Error updating profile:', error);
                showNotification('Error updating profile', 'error');
            }
        }

        async function changePassword(event) {
            event.preventDefault();
            
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (newPassword !== confirmPassword) {
                showNotification('New passwords do not match', 'error');
                return;
            }
            
            try {
                // In a real implementation, you would make an API call
                // const response = await fetch(`${API_BASE}/admin/change-password`, {
                //     method: 'POST',
                //     headers: { 'Content-Type': 'application/json' },
                //     body: JSON.stringify({ currentPassword, newPassword })
                // });
                
                document.getElementById('passwordForm').reset();
                showNotification('Password changed successfully!', 'success');
                
            } catch (error) {
                console.error('Error changing password:', error);
                showNotification('Error changing password', 'error');
            }
        }

        async function updateDealershipInfo(event) {
            event.preventDefault();
            
            const dealershipData = {
                name: document.getElementById('dealershipName').value,
                license: document.getElementById('businessLicense').value,
                phone: document.getElementById('dealershipPhone').value,
                email: document.getElementById('dealershipEmail').value,
                address: document.getElementById('dealershipAddress').value,
                website: document.getElementById('dealershipWebsite').value,
                taxId: document.getElementById('taxId').value,
                weekdayHours: document.getElementById('weekdayHours').value,
                weekendHours: document.getElementById('weekendHours').value
            };
            
            try {
                // In a real implementation, you would make an API call
                // const response = await fetch(`${API_BASE}/admin/dealership`, {
                //     method: 'PUT',
                //     headers: { 'Content-Type': 'application/json' },
                //     body: JSON.stringify(dealershipData)
                // });
                
                showNotification('Dealership information updated successfully!', 'success');
                
            } catch (error) {
                console.error('Error updating dealership info:', error);
                showNotification('Error updating dealership information', 'error');
            }
        }

        async function loadDataCounts() {
            try {
                // In a real implementation, you would fetch actual counts
                // const response = await fetch(`${API_BASE}/admin/stats`);
                // const data = await response.json();
                
                // For now, use sample data
                document.getElementById('vehicleCount').textContent = '142';
                document.getElementById('customerCount').textContent = '356';
                document.getElementById('orderCount').textContent = '89';
                
            } catch (error) {
                console.error('Error loading data counts:', error);
            }
        }

        async function testApiConnection() {
            try {
                const apiUrl = document.getElementById('apiBaseUrl').value;
                // const response = await fetch(`${apiUrl}/health`);
                
                // Simulate API test
                showNotification('API connection successful!', 'success');
                
            } catch (error) {
                console.error('API connection failed:', error);
                showNotification('API connection failed', 'error');
            }
        }

        async function createBackup() {
            try {
                showNotification('Creating backup...', 'info');
                
                // Simulate backup creation
                setTimeout(() => {
                    showNotification('Backup created successfully!', 'success');
                }, 3000);
                
            } catch (error) {
                console.error('Error creating backup:', error);
                showNotification('Error creating backup', 'error');
            }
        }

        function restoreBackup() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.sql,.json,.zip';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    if (confirm(`Are you sure you want to restore from ${file.name}? This will overwrite all current data.`)) {
                        showNotification('Restoring backup...', 'info');
                        // Simulate restore process
                        setTimeout(() => {
                            showNotification('Backup restored successfully!', 'success');
                        }, 5000);
                    }
                }
            };
            input.click();
        }

        async function exportData() {
            try {
                showNotification('Exporting data...', 'info');
                
                // Simulate data export
                setTimeout(() => {
                    const link = document.createElement('a');
                    link.href = 'data:text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify({
                        vehicles: [],
                        customers: [],
                        orders: [],
                        exportDate: new Date().toISOString()
                    }));
                    link.download = `prestigio_data_${new Date().toISOString().split('T')[0]}.json`;
                    link.click();
                    
                    showNotification('Data exported successfully!', 'success');
                }, 2000);
                
            } catch (error) {
                console.error('Error exporting data:', error);
                showNotification('Error exporting data', 'error');
            }
        }

        async function clearCache() {
            try {
                showNotification('Clearing cache...', 'info');
                
                // Clear localStorage
                localStorage.clear();
                
                setTimeout(() => {
                    showNotification('Cache cleared successfully!', 'success');
                }, 1000);
                
            } catch (error) {
                console.error('Error clearing cache:', error);
                showNotification('Error clearing cache', 'error');
            }
        }

        function resetDatabase() {
            if (confirm('Are you sure you want to reset the database? This will delete ALL data and cannot be undone.')) {
                if (confirm('This is your final warning. All vehicles, customers, orders, and messages will be permanently deleted. Continue?')) {
                    showNotification('Resetting database...', 'info');
                    
                    // Simulate database reset
                    setTimeout(() => {
                        showNotification('Database reset completed!', 'success');
                        loadDataCounts();
                    }, 3000);
                }
            }
        }

        function logoutAllSessions() {
            if (confirm('Are you sure you want to logout all active sessions? You will need to login again.')) {
                showNotification('Logging out all sessions...', 'info');
                
                setTimeout(() => {
                    localStorage.clear();
                    window.location.href = '/admin/login';
                }, 2000);
            }
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg text-white z-50 ${
                type === 'success' ? 'bg-green-600' : 
                type === 'error' ? 'bg-red-600' : 
                type === 'info' ? 'bg-blue-600' : 'bg-gray-600'
            }`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 3000);
        }

        // Auto-save settings on change
        document.addEventListener('change', function(event) {
            if (event.target.type === 'checkbox' || event.target.tagName === 'SELECT') {
                const setting = event.target.id;
                const value = event.target.type === 'checkbox' ? event.target.checked : event.target.value;
                
                // Save to localStorage for persistence
                localStorage.setItem(`admin_setting_${setting}`, JSON.stringify(value));
                
                showNotification('Setting saved', 'success');
            }
        });

        // Load saved settings
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('input[type="checkbox"], select').forEach(element => {
                const savedValue = localStorage.getItem(`admin_setting_${element.id}`);
                if (savedValue !== null) {
                    const value = JSON.parse(savedValue);
                    if (element.type === 'checkbox') {
                        element.checked = value;
                    } else {
                        element.value = value;
                    }
                }
            });
        });
    </script>
</body>
</html> 